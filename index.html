<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Farm lol</title>
<style>
  :root{ --bg:#e1f5d3; --card:#ffffffcc; --muted:#5f6f52; --accent:#4caf50; }
  *{box-sizing:border-box}
  body{ margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;
        /* ÄÃƒ CHá»ˆNH Sá»¬A: CHá»ˆ DÃ™NG MÃ€U Ná»€N Cá»¨NG */
        background: var(--bg);
        /* Káº¾T THÃšC CHá»ˆNH Sá»¬A */
        color:#2b3a1f; min-height:100vh; display:flex; flex-direction:column; }
  header{ display:flex; align-items:center; justify-content:space-between;
          padding:16px 20px; border-bottom:1px solid rgba(0,0,0,0.07);
          backdrop-filter:blur(6px); background:#ffffff88; white-space:nowrap; }
  
  /* ÄÃƒ CHá»ˆNH Sá»¬A: XÃ“A áº¢NH Ná»€N VÃ€ CÄ‚N CHá»ˆNH */
  main{ flex:1; display:flex; justify-content:center; 
        align-items:flex-start; /* Giá»¯ cÄƒn lÃªn trÃªn */
        padding:0; 
        /* XÃ“A áº¢NH Ná»€N */
        overflow: hidden;
        /* THÃŠM: Thiáº¿t láº­p main lÃ m gá»‘c cho Ä‘á»‹nh vá»‹ tuyá»‡t Ä‘á»‘i cá»§a áº£nh */
        position: relative;
  }
  main > div {
    display: none; /* áº¨n div trá»‘ng */
  }
  
  /* THÃŠM CSS CHO áº¢NH Ná»€N */
  #beanstalk-bg {
    position: absolute; /* Äá»‹nh vá»‹ tuyá»‡t Ä‘á»‘i Ä‘á»ƒ náº±m dÆ°á»›i header */
    top: 0; /* Äáº·t áº£nh ngay dÆ°á»›i header (tÆ°Æ¡ng á»©ng vá»›i top cá»§a main) */
    left: 50%; /* CÄƒn giá»¯a theo chiá»u ngang */
    transform: translateX(-50%); /* Dá»‹ch chuyá»ƒn ngÆ°á»£c 50% chiá»u rá»™ng Ä‘á»ƒ cÄƒn chÃ­nh xÃ¡c */
    max-width: 100%; /* Äáº£m báº£o áº£nh khÃ´ng trÃ n mÃ n mÃ n hÃ¬nh ngang */
    height: auto;
    z-index: 1; /* Äáº£m báº£o áº£nh náº±m á»Ÿ lá»›p dÆ°á»›i so vá»›i cÃ¡c popup, nhÆ°ng trÃªn ná»n */
    /* Äiá»u chá»‰nh náº¿u cáº§n: Ä‘áº·t chiá»u cao cá»‘ Ä‘á»‹nh hoáº·c max-height */
    max-height: 90vh;
  }
  /* Káº¾T THÃšC THÃŠM CSS CHO áº¢NH Ná»€N */

  /* THÃŠM CSS CHO BÃ“NG ÄÃˆN */
  #light-bulb {
      position: absolute;
      /* ÄÃƒ CHá»ˆNH Sá»¬A: XÃ­ch xuá»‘ng 8px */
      top: 8px; 
      /* ÄÃƒ CHá»ˆNH Sá»¬A: Dá»‹ch sang trÃ¡i 30% (Tá»« 45% sang 30%) */
      left: 30%; 
      transform: translateX(-50%);
      width: 60px; /* KÃ­ch thÆ°á»›c phÃ¹ há»£p */
      height: auto;
      z-index: 8; /* TrÃªn áº£nh ná»n, dÆ°á»›i cÃ¡c popup */
      cursor: pointer; /* THÃŠM: Cho biáº¿t cÃ³ thá»ƒ click */
  }
  /* Káº¾T THÃšC THÃŠM CSS CHO BÃ“NG ÄÃˆN */

  /* *** ÄÃƒ CHá»ˆNH Sá»¬A: CÃ‚N Äáº¨U VÃ‚N (Slot 0) - Dá»‹ch chuyá»ƒn lÃªn trÃªn 100px (150px -> 50px) *** */
  #kinto-cloud {
      position: absolute; /* Äá»‹nh vá»‹ tuyá»‡t Ä‘á»‘i */
      top: 50px; /* <--- ÄÃƒ CHá»ˆNH Sá»¬A: Giáº£m xuá»‘ng 50px Ä‘á»ƒ xÃ­ch lÃªn trÃªn */
      left: 60%; /* Giá»¯ nguyÃªn vá»‹ trÃ­ ngang */
      transform: translateX(-50%); /* Dá»‹ch chuyá»ƒn ngÆ°á»£c 50% chiá»u rá»™ng Ä‘á»ƒ cÄƒn chÃ­nh xÃ¡c */
      width: 80px; /* Giáº£m kÃ­ch thÆ°á»›c xuá»‘ng 80px */
      height: 80px; /* Giáº£m kÃ­ch thÆ°á»›c xuá»‘ng 80px */
      z-index: 10; /* Äáº£m báº£o náº±m trÃªn má»i thá»© (trá»« popup) */
      cursor: pointer; /* Cho biáº¿t cÃ³ thá»ƒ click */
      transition: transform 0.1s, box-shadow 0.1s; 
  }
  /* *** Káº¾T THÃšC Sá»¬A CSS CÃ‚N Äáº¨U VÃ‚N *** */

  /* THÃŠM CSS CHO Ã” Äáº¶T CHáº¬U */
  #pot-container {
      position: absolute;
      top: 0; /* CÄƒn vá»›i top cá»§a main/beanstalk-bg */
      left: 50%;
      transform: translateX(-50%);
      /* Tá»‘i Ä‘a hÃ³a kÃ­ch thÆ°á»›c vÃ¹ng chá»©a Ã´ Ä‘á»ƒ khá»›p vá»›i áº£nh ná»n beanstalk-bg */
      max-width: 100%; 
      max-height: 90vh; /* Giá»‘ng max-height cá»§a beanstalk-bg */
      width: 100vw; /* Chiá»u rá»™ng ban Ä‘áº§u báº±ng viewport */
      height: 100vh; /* Chiá»u cao ban Ä‘áº§u báº±ng viewport */
      z-index: 5; /* Äáº·t trÃªn áº£nh ná»n nhÆ°ng dÆ°á»›i popup */
      display: flex;
      justify-content: center;
      pointer-events: none; /* Máº·c Ä‘á»‹nh khÃ´ng nháº­n click, chá»‰ cÃ¡c Ã´ con nháº­n */
  }

  /* ÄÃƒ CHá»ˆNH Sá»¬A: KÃ­ch thÆ°á»›c Ã´ nhá» hÆ¡n */
  .pot-slot {
      position: absolute;
      width: 50px; /* ÄÃ£ giáº£m tá»« 70px xuá»‘ng 50px */
      height: 50px; /* ÄÃ£ giáº£m tá»« 70px xuá»‘ng 50px */
      background: rgba(100, 150, 100, 0.5); /* MÃ u ná»n má» dá»… nhÃ¬n */
      border-radius: 50%; /* HÃ¬nh trÃ²n */
      border: 2px dashed var(--accent); /* Giáº£m Ä‘á»™ dÃ y viá»n */
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1em; /* Giáº£m cá»¡ chá»¯ */
      color: white; /* MÃ u chá»¯ sá»‘ */
      cursor: pointer;
      transition: transform 0.1s, box-shadow 0.1s;
      pointer-events: auto; /* Cho phÃ©p nháº­n click */
  }

  /* THÃŠM: CSS cho áº£nh cháº­u Ä‘áº¥t bÃªn trong pot-slot */
  .pot-slot img {
      width: 120%; /* PhÃ³ng to áº£nh Ä‘á»ƒ láº¥p Ä‘áº§y Ã´ */
      height: 120%; /* PhÃ³ng to áº£nh Ä‘á»ƒ láº¥p Ä‘áº§y Ã´ */
      object-fit: contain;
      position: absolute; /* Äá»‹nh vá»‹ tuyá»‡t Ä‘á»‘i trong Ã´ */
      /* Äá»ƒ cháº­u náº±m cÃ¢n Ä‘á»‘i hÆ¡n trong hÃ¬nh trÃ²n 50x50 */
      top: -10px; 
      left: -10px;
  }
  /* Káº¾T THÃšC THÃŠM CSS */

  /* ÄÃƒ THÃŠM: CSS cho áº£nh nhÃ¢n váº­t trong Slot 1 */
  #slot-1 img {
      width: 150%; /* TÄƒng kÃ­ch thÆ°á»›c áº£nh nhÃ¢n váº­t */
      height: 150%; /* TÄƒng kÃ­ch thÆ°á»›c áº£nh nhÃ¢n váº­t */
      top: -30px; /* Dá»‹ch chuyá»ƒn lÃªn trÃªn Ä‘á»ƒ cÃ¢n báº±ng */
      left: -20px; /* Dá»‹ch chuyá»ƒn sang trÃ¡i má»™t chÃºt */
  }
  /* Káº¾T THÃšC THÃŠM CSS */

  /* ÄÃƒ CHá»ˆNH Sá»¬A: Vá»‹ trÃ­ cá»§a tá»«ng Ã´ Ä‘á»ƒ chÃºng NGANG HÃ€NG vÃ  SÃT NHAU HÆ N */
  /* *** ÄÃƒ CHá»ˆNH Sá»¬A: Dá»ŠCH CHUYá»‚N TOÃ€N Bá»˜ LÃŠN TRÃŠN (170px -> 165px) *** */
  /* CÄƒn vá»‹ trÃ­ dá»±a trÃªn pháº§n tá»­ cha #pot-container */
  #slot-1 { top: 165px; left: calc(50% - 150px + 20px); } /* Cá»±c TrÃ¡i */
  #slot-2 { top: 165px; left: calc(50% - 90px + 10px); }  /* Giá»¯a-TrÃ¡i */
  #slot-3 { top: 165px; left: calc(50% - 30px + 10px); }   /* Giá»¯a */
  
  /* === ÄÃƒ CHá»ˆNH Sá»¬A: CSS Äá»ŠNH Vá»Š CHO SLOT 6 (PhÃ­a dÆ°á»›i Slot 3) - Dá»ŠCH LÃŠN 50PX (425px -> 375px) === */
  #slot-6 { top: 375px; left: calc(50% - 30px + 10px); }
  /* ==================================================== */

  #slot-4 { top: 165px; left: calc(50% + 30px + 10px); }  /* Giá»¯a-Pháº£i */
  #slot-5 { top: 165px; left: calc(50% + 90px + 10px); } /* Cá»±c Pháº£i */
  
  /* THÃŠM: XÃ³a viá»n ná»n click cá»§a cÃ¡c Ã´ cháº­u Ä‘Ã£ cÃ³ cháº­u Ä‘áº¥t (slot-2 Ä‘áº¿n slot-5) */
  #slot-2, #slot-3, #slot-4, #slot-5 {
      background: transparent; /* XÃ³a ná»n má» */
      border: none;          /* XÃ³a viá»n nÃ©t Ä‘á»©t */
  }
  
  /* ÄÃƒ CHá»ˆ Sá»¬A: XÃ“A viá»n ná»n click cá»§a #slot-1 (vÃ¬ giá» Ä‘Ã£ cÃ³ áº£nh) */
  #slot-1 {
      background: transparent; /* XÃ³a ná»n má» */
      border: none;          /* XÃ³a viá»n nÃ©t Ä‘á»©t */
  }

  /* === ÄÃƒ THÃŠM: CSS cho Slot 6 (NhÃ¢n váº­t ngá»“i cáº§m bÃ¡t) === */
  #slot-6 {
      background: transparent; /* XÃ³a ná»n má» */
      border: none;          /* XÃ³a viá»n nÃ©t Ä‘á»©t */
  }
  #slot-6 img {
      width: 200%; /* TÄƒng kÃ­ch thÆ°á»›c áº£nh */
      height: 200%; 
      top: -50px; /* Dá»‹ch chuyá»ƒn lÃªn trÃªn Ä‘á»ƒ cÃ¢n báº±ng */
      left: -25px; /* Dá»‹ch chuyá»ƒn sang trÃ¡i má»™t chÃºt */
  }
  /* ==================================================== */

  /* ÄÃƒ CHá»ˆ Sá»¬A: XÃ“A TOÃ€N Bá»˜ CSS Cá»¦A .bottom-menu */
  /* .bottom-menu{ display:flex; justify-content:center; gap:20px; padding:14px 0; background:#ffffffaa; backdrop-filter:blur(6px); border-top:1px solid rgba(0,0,0,0.07); font-size:20px; font-weight:600; } */ 
  #exp-popup{ position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; border-radius:12px; box-shadow:0 4px 18px rgba(0,0,0,0.25); display:none; z-index:999; text-align:center; min-width:240px; }
  
</style>
</head>
<body>
<header>
  <div class="brand"><div style="font-weight:700">ğŸŒ¾ Farm LOL ğŸŒ¾</div></div>
  <div class="controls">
    <button id="btn-new">ğŸ†• Táº¡o</button>
    <button id="btn-delete" disabled>ğŸ—‘ï¸ XoÃ¡</button>
    <button id="btn-save" disabled>ğŸ’¾ LÆ°u</button>
  </div>
</header>

<div id="name-box" style="display:none; text-align:center; padding:15px; font-size:22px;">
<div style="font-weight:600; margin-bottom:10px;">Xin chÃ o nÃ´ng dÃ¢n!</div>
TÃªn báº¡n lÃ  gÃ¬?
<input type="text" id="player-name" placeholder="VÃ­ dá»¥: Alice" style="margin:10px 0; padding:8px; border-radius:6px; border:1px solid #ccc; width:80%; max-width:200px;" />
<br>
<button id="btn-next">Tiáº¿p theo &rarr;</button>
</div>

<div id="choose-box" style="display:none; text-align:center; padding:15px; font-size:26px;">
<div style="font-weight:600; margin-bottom:10px;">Chá»n icon nÃ´ng tráº¡i!</div>
<div id="icon-choices" style="display:flex; justify-content:center; gap:15px;">
  <button class="choose-icon" data-icon="ğŸ ">ğŸ </button>
  <button class="choose-icon" data-icon="ğŸ¡">ğŸ¡</button>
  <button class="choose-icon" data-icon="ğŸ°">ğŸ°</button>
</div>
</div>

<div id="equip-box" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; border-radius:12px; box-shadow:0 4px 18px rgba(0,0,0,0.25); text-align:center; min-width:260px; z-index:999;">
<h3>âš’ï¸ Trang bá»‹</h3>
<div style="text-align:left; margin-bottom:10px;">
  <div id="tool-name"></div>
  <div id="tool-desc" style="font-size:0.9em; color:#5f6f52;"></div>
</div>
<hr style="border:0; border-top:1px solid #eee; margin:10px 0;" />
<div style="display:flex; justify-content:space-between; margin-bottom:10px;">
  <div>Sá»©c máº¡nh: <span id="tool-pow"></span></div>
  <div>Äá»™ bá»n: <span id="tool-hp"></span></div>
</div>
<button id="btn-equip-close" onclick="equipBox.style.display='none'">ÄÃ³ng</button>
</div>

<div id="shop-box" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; border-radius:12px; box-shadow:0 4px 18px rgba(0,0,0,0.25); text-align:center; min-width:260px; z-index:999;">
<h3>ğŸ’° Cá»­a hÃ ng</h3>
<div style="font-size:0.9em; margin-bottom:10px; color:var(--muted);">
  Xu: <span id="coin-xu">0</span> | USD: <span id="coin-usd">0</span>
</div>
<hr style="border:0; border-top:1px solid #eee; margin:10px 0;" />
<div id="shop-items" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
  </div>
<button onclick="shopBox.style.display='none'" style="margin-top:15px;">ÄÃ³ng</button>
</div>

<div id="online-box" style="display:none; position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); background:white; padding:20px; border-radius:12px; box-shadow:0 4px 18px rgba(0,0,0,0.25); text-align:center; min-width:260px; z-index:999;">
<h3>ğŸŒ Online</h3>
<div style="margin-bottom:15px;">
  Chá»©c nÄƒng nÃ y hiá»‡n chÆ°a kháº£ dá»¥ng.
</div>
<button onclick="onlineBox.style.display='none'">ÄÃ³ng</button>
</div>

<div id="exp-popup">
  <h3>ğŸ“Š Kinh nghiá»‡m</h3>
  <div id="exp-text"></div>
  <br>
  <button onclick="expPopup.style.display='none'">ÄÃ³ng</button>
</div>

<main>
  <img id="beanstalk-bg" src="1000000683.jpg" alt="CÃ¢y Ä‘áº­u tháº§n" />
  
  <img id="light-bulb" src="bongdensoidot.png" alt="BÃ³ng Ä‘Ã¨n sá»£i Ä‘á»‘t" />
  <div id="pot-container">
    <div class="pot-slot" id="slot-1" data-slot="1">
        <img src="1763444144946.png" alt="NhÃ¢n váº­t Ä‘en-Ä‘á»" />
    </div>
    
    <div class="pot-slot" id="slot-2" data-slot="2">
        <img src="1763442967614.png" alt="Cháº­u Ä‘áº¥t" />
    </div>
    <div class="pot-slot" id="slot-3" data-slot="3">
        <img src="1763442967614.png" alt="Cháº­u Ä‘áº¥t" />
    </div>
    
    <div class="pot-slot" id="slot-6" data-slot="6">
        <img src="1000000688.png" alt="NhÃ¢n váº­t ngá»“i cáº§m bÃ¡t" />
    </div>
    <div class="pot-slot" id="slot-4" data-slot="4">
        <img src="1763442967614.png" alt="Cháº­u Ä‘áº¥t" />
    </div>
    <div class="pot-slot" id="slot-5" data-slot="5">
        <img src="1763442967614.png" alt="Cháº­u Ä‘áº¥t" />
    </div>
    </div>
  
  <img id="kinto-cloud" src="candauvan.png" alt="CÃ¢n Äáº©u VÃ¢n" data-slot="0" />
  
  <div>
    </div>
</main>

<script>
// ==== Biáº¿n Tráº¡ng thÃ¡i TrÃ² chÆ¡i ==== //
let playerName = "NÃ´ng dÃ¢n";
let farmIcon = "ğŸŒ¾";
let level = 0;
let exp = 0;
let xu = 0;
let usd = 0;
let tool = { name: "Xáº»ng Gá»—", power: 1, maxHP: 100, currentHP: 100 };
let shopItems = [
  { id: 1, name: "GÃ³i Xu Nhá»", price: 1, currency: "usd", type: "currency", value: 100 },
  { id: 2, name: "BÃºa Sáº¯t", price: 500, currency: "xu", type: "tool", value: { name: "BÃºa Sáº¯t", power: 3, maxHP: 250, currentHP: 250 } },
];
let farmSlots = Array(5).fill(null); // 5 Ã´ trá»“ng cÃ¢y

// ==== Biáº¿n DOM ==== //
const btnNew = document.getElementById("btn-new");
const btnDelete = document.getElementById("btn-delete"); 
const btnSave = document.getElementById("btn-save");     
const nameBox = document.getElementById("name-box");
const chooseBox = document.getElementById("choose-box");
const btnNext = document.getElementById("btn-next");
const nameInput = document.getElementById("player-name");
const chooseIcons = document.querySelectorAll(".choose-icon");
const expFill = document.getElementById("exp-fill");
const shopBox = document.getElementById("shop-box");
const coinXu = document.getElementById("coin-xu");
const coinUSD = document.getElementById("coin-usd");
const expText = document.getElementById("exp-text");
const expPopup = document.getElementById("exp-popup");
const onlineBox = document.getElementById("online-box");
const shopItemsContainer = document.getElementById("shop-items");
const equipBox = document.getElementById("equip-box");

// ==== HÃ€M LOGIC CHÃNH ==== //
function expNeeded(lv){ return lv * 100; }

function updateDisplay(){
  // Kiá»ƒm tra tá»“n táº¡i vÃ  cáº­p nháº­t EXP bar (náº¿u cÃ³)
  const expBar = document.querySelector("#exp-bar");
  if(level > 0 && expBar){
      expBar.style.width = (exp / expNeeded(level)) * 100 + "%";
  }

  // Cáº­p nháº­t tiá»n tá»‡
  if (coinXu) coinXu.textContent = xu.toLocaleString('vi-VN');
  if (coinUSD) coinUSD.textContent = usd.toLocaleString('vi-VN');
}

function updateShop(){
  if(!shopItemsContainer) return;
  shopItemsContainer.innerHTML = "";
  shopItems.forEach(item => {
    const itemDiv = document.createElement("div");
    itemDiv.className = "shop-item";
    itemDiv.style.border = "1px solid var(--muted)";
    itemDiv.style.borderRadius = "8px";
    itemDiv.style.padding = "10px";
    itemDiv.style.textAlign = "center";
    itemDiv.innerHTML = `
      <div style="font-weight:600;">${item.name}</div>
      <div style="font-size:0.9em; margin:5px 0;">${item.currency === "xu" ? 'Xu' : 'USD'}: ${item.price}</div>
      <button class="btn-buy" data-id="${item.id}" style="padding:5px 10px; border:none; border-radius:5px; background:var(--accent); color:white; cursor:pointer;">
        Mua
      </button>
    `;
    shopItemsContainer.appendChild(itemDiv);
  });
  
  // Gáº¯n sá»± kiá»‡n mua hÃ ng
  document.querySelectorAll(".btn-buy").forEach(btn => {
    btn.addEventListener("click", handleBuy);
  });
}

function updateControlButtons(){
  const hasGame = level > 0;
  btnNew.disabled = hasGame;
  btnDelete.disabled = !hasGame;
  btnSave.disabled = !hasGame;
}

function handleBuy(event) {
  const itemId = parseInt(event.target.getAttribute("data-id"));
  const item = shopItems.find(i => i.id === itemId);
  if (!item) return;

  let canBuy = false;
  if (item.currency === "xu" && xu >= item.price) {
    xu -= item.price;
    canBuy = true;
  } else if (item.currency === "usd" && usd >= item.price) {
    usd -= item.price;
    canBuy = true;
  }

  if (canBuy) {
    if (item.type === "currency") {
      if (item.currency === "usd") {
        xu += item.value;
        alert(`Báº¡n Ä‘Ã£ mua thÃ nh cÃ´ng ${item.name}! Nháº­n ${item.value} Xu.`);
      }
    } else if (item.type === "tool") {
      tool = item.value;
      alert(`Báº¡n Ä‘Ã£ trang bá»‹ ${item.name}!`);
    }
    updateDisplay();
    updateShop(); // Cáº­p nháº­t láº¡i cá»­a hÃ ng sau khi mua
  } else {
    alert("KhÃ´ng Ä‘á»§ tiá»n!");
  }
}

// HÃ m Xá»­ lÃ½ Táº¡o game má»›i
function handleNewGame(){
    nameBox.style.display = 'block';
}

btnNew.addEventListener('click', handleNewGame);

btnNext.addEventListener('click', () => {
    playerName = nameInput.value || "NÃ´ng dÃ¢n";
    nameBox.style.display = 'none';
    chooseBox.style.display = 'block';
});

chooseIcons.forEach(btn => {
    btn.addEventListener('click', (e) => {
        farmIcon = e.target.getAttribute('data-icon');
        // Khá»Ÿi táº¡o game
        level = 1;
        exp = 0;
        xu = 100; // Tiá»n khá»Ÿi táº¡o
        usd = 1;  // Tiá»n khá»Ÿi táº¡o
        
        chooseBox.style.display = 'none';
        
        // ThÃªm thÃ´ng bÃ¡o
        alert(`ChÃ o má»«ng ${playerName} (${farmIcon}) Ä‘áº¿n vá»›i Farm LOL!`);
        
        updateDisplay();
        updateControlButtons();
        saveGame();
    });
});

// HÃ m Táº£i game
function loadGame(){
    const savedGame = localStorage.getItem('farmLolGame');
    if(savedGame){
        const gameData = JSON.parse(savedGame);
        playerName = gameData.playerName;
        farmIcon = gameData.farmIcon;
        level = gameData.level;
        exp = gameData.exp;
        xu = gameData.xu;
        usd = gameData.usd;
        tool = gameData.tool;
        farmSlots = gameData.farmSlots;
        
        // ThÃªm thÃ´ng bÃ¡o
        console.log(`ÄÃ£ táº£i game cá»§a ${playerName} (Cáº¥p ${level})`);
    }
}

// HÃ m LÆ°u game
function saveGame(){
    const gameData = { playerName, farmIcon, level, exp, xu, usd, tool, farmSlots };
    localStorage.setItem('farmLolGame', JSON.stringify(gameData));
    alert("ÄÃ£ lÆ°u trÃ² chÆ¡i!");
}
btnSave.addEventListener('click', saveGame);

// HÃ m XÃ³a game
function deleteGame(){
    if(confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a nÃ´ng tráº¡i hiá»‡n táº¡i?")){
        localStorage.removeItem('farmLolGame');
        // Reset biáº¿n tráº¡ng thÃ¡i
        playerName = "NÃ´ng dÃ¢n";
        farmIcon = "ğŸŒ¾";
        level = 0;
        exp = 0;
        xu = 0;
        usd = 0;
        tool = { name: "Xáº»ng Gá»—", power: 1, maxHP: 100, currentHP: 100 };
        farmSlots = Array(5).fill(null);
        
        alert("ÄÃ£ xÃ³a nÃ´ng tráº¡i!");
        updateDisplay();
        updateControlButtons();
    }
}
btnDelete.addEventListener('click', deleteGame);

// === THÃŠM: LOGIC CHO CÃC NÃšT CLICK (Ãnh xáº¡ vá»›i áº£nh) ===

// 1. CÃ‚N Äáº¨U VÃ‚N (Slot 0) - Má»Ÿ Cá»­a hÃ ng
const kintoCloud = document.getElementById("kinto-cloud");
if (kintoCloud) {
    kintoCloud.addEventListener("click", () => {
        if (level === 0) {
            alert("Báº¡n cáº§n táº¡o nÃ´ng tráº¡i trÆ°á»›c! Vui lÃ²ng nháº¥n nÃºt 'ğŸ†• Táº¡o' á»Ÿ trÃªn.");
            return;
        }
        updateShop(); // Äáº£m báº£o cá»­a hÃ ng Ä‘Æ°á»£c cáº­p nháº­t
        shopBox.style.display = 'block';
    });
}

// 2. BÃ“NG ÄÃˆN Sá»¢I Äá»T - Má»Ÿ Trang bá»‹ (CÃ´ng cá»¥)
const lightBulb = document.getElementById("light-bulb");
if (lightBulb) {
    lightBulb.addEventListener("click", () => {
        if (level === 0) {
            alert("Báº¡n cáº§n táº¡o nÃ´ng tráº¡i trÆ°á»›c! Vui lÃ²ng nháº¥n nÃºt 'ğŸ†• Táº¡o' á»Ÿ trÃªn.");
            return;
        }
        // Cáº­p nháº­t ná»™i dung popup Trang bá»‹
        document.getElementById("tool-name").textContent = tool.name;
        document.getElementById("tool-desc").textContent = "CÃ´ng cá»¥ thu hoáº¡ch cÆ¡ báº£n"; // MÃ´ táº£ máº·c Ä‘á»‹nh
        document.getElementById("tool-pow").textContent = tool.power;
        document.getElementById("tool-hp").textContent = `${tool.currentHP}/${tool.maxHP}`;
        
        equipBox.style.display = 'block';
    });
}

// 3. CÃC Ã” CHáº¬U (Slot 1 Ä‘áº¿n Slot 6) - Hiá»‡n popup EXP (Táº¡m thá»i)
const potSlots = document.querySelectorAll(".pot-slot");
potSlots.forEach(slot => {
    slot.addEventListener("click", () => {
        if (level === 0) {
            alert("Báº¡n cáº§n táº¡o nÃ´ng tráº¡i trÆ°á»›c! Vui lÃ²ng nháº¥n nÃºt 'ğŸ†• Táº¡o' á»Ÿ trÃªn.");
            return;
        }
        const slotNum = slot.getAttribute('data-slot');
        // Logic Táº¡m thá»i: Khi click vÃ o Ã´ cháº­u (hoáº·c áº£nh nhÃ¢n váº­t trong Ä‘Ã³) sáº½ hiá»‡n popup EXP.
        expText.innerHTML = `Báº¡n Ä‘Ã£ kiá»ƒm tra **Ã” ${slotNum}**.<br>Chá»©c nÄƒng trá»“ng trá»t/thu hoáº¡ch sáº½ cÃ³ á»Ÿ phiÃªn báº£n tiáº¿p theo!`;
        expPopup.style.display = 'block';
    });
});

// === Káº¾T THÃšC THÃŠM LOGIC CHO CÃC NÃšT CLICK ===

// HÃ m Khá»Ÿi táº¡o/Táº£i game
function initializeGame(){
    loadGame(); // Táº£i dá»¯ liá»‡u tá»« Local Storage
    updateDisplay();
    updateControlButtons();
}
// Cháº¡y hÃ m khá»Ÿi táº¡o khi trang táº£i xong
window.onload = initializeGame;
</script>
</body>
</html>
